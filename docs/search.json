[
  {
    "objectID": "Readings.html",
    "href": "Readings.html",
    "title": "Readings",
    "section": "",
    "text": "For each topic, there will be a required reading (or pre-class activity) and several optional readings.\nWe expect you to have read the required reading before the day. There will not be time during the week of the course to read new materials and therefore we highly suggest that you do these readings in advance of the course starting.\n\n\n\n\n\n\nIf you are new to R, please attempt the following tutorials on your own. If you are experienced in R, skim through the tutorials and make sure that all the topics are familiar to you.\n\nRavinet’s introduction to R\nGoing further with R\n\nThrough this course, most of the examples you are likely to encounter will predominately use base R. However, learning Tidyverse syntax will make your life easier in the long run, especially if you are going to be manipulating spatial data.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStorfer, A., Patton, A., & Fraik, A. K. (2018). Navigating the interface between landscape genetics and landscape genomics. Front Genet, 9, 68. doi:10.3389/fgene.2018.00068\n\n\n\n\n\nManel, S., Schwartz, M. K., Luikart, G., & Taberlet, P. (2003). Landscape genetics: combining landscape ecology and population genetics. Trends in Ecology and Evolution, 18(4), 189-197. doi:papers3://publication/doi/10.1016/S0169-5347(03)00008-9 This is the original paper defining landscape genetics as a field.\nFind a good terrestrial overview\nRiginos, C., & Liggins, L. (2013). Seascape genetics: populations, individuals, and genes marooned and adrift. Geography Compass, 7(3), 197-216. doi:papers3://publication/doi/10.1111/gec3.12032 Discusses many ways that marine landscape genetics is distinct from terrestrial\nSelkoe, K. A., Scribner, K. T., & Galindo, H. M. (2016). Waterscape genetics – applications of landscape genetics to rivers, lakes, and seas. In N. Balkenhol, S. A. Cushman, A. Storfer, & L. P. Waits (Eds.), Landscape Genetics: Concepts, Methods, Applications (pp. 1-27): John Wiley & Sons, Ltd. Includes overviews on some of the contrasting features of marine and freshwater environments\nLiggins, L., Treml, E. A., & Riginos, C. (2019). Seascape genomics: contextualizing adaptive and neutral genomic variation in the ocean environment. Overviews on issues particular to marine studies\nBlanchet, S., Prunier, J. G., Paz-Vinas, I., Saint-Pe, K., Rey, O., Raffard, A., Mathieu-Begne, E., Loot, G., Fourtune, L., & Dubut, V. (2020). A river runs through it: The causes, consequences, and management of intraspecific diversity in river networks. Evolutionary Applications, 13(6), 1195-1213. doi:10.1111/eva.12941 Features and emerging conclusions from freshwater systems\n\n\n\n\n\n\n\nNo readings are required.\n\n\n\n\nThe best website explaining how to use spatial data in R is [Geocomputation with R, a book on geographic data analysis, visualization and modeling](https://r.geocompx.org)\nLeempoel, K., Duruz, S., Rochat, E., Widmer, I., Orozco-terWengel, P., & Joost, S. (2017). Simple rules for an efficient use of geographic information systems in molecular ecology. _Frontiers in Ecology and Evolution, 5_. doi:10.3389/fevo.2017.00033 *Reviews various approaches and tools, good list of terrestrial environmental data sources included in appendix*\n\n\n\n\n\n\n\n\n\n\n\nMeier, J.I., Sousa, V.C., Marques, D.A., Selz, O.M., Wagner, C.E., Excoffier, L. and Seehausen, O. (2017), Demographic modelling with whole-genome data reveals parallel origin of similar Pundamilia cichlid species after hybridization. Mol Ecol, 26: 123-141. https://doi.org/10.1111/mec.13838\n\n\n\n\n\n\n\n\n\n\n\nCapblancq, T., & Forester, B. R. (2021). Redundancy analysis: A Swiss Army Knife for landscape genomics. Methods in Ecology and Evolution. doi:10.1111/2041-210x.13722 Clear explanations and worked examples that we will follow in class\n\n\n\n\n\nRellstab, C., Gugerli, F., Eckert, A. J., Hancock, A. M., & Holderegger, R. (2015). A practical guide to environmental association analysis in landscape genomics. Molecular Ecology, 24(17), 4348-4370. doi:papers3://publication/doi/10.1111/mec.13322 Highly recommend reading as a general overview to GEA/EEA analyses and concepts\nForester, B. R., Jones, M. R., Joost, S., Landguth, E. L., & Lasky, J. R. (2016). Detecting spatial genetic signatures of local adaptation in heterogeneous landscapes. Molecular Ecology, 25(1), 104-120. doi:papers3://publication/doi/10.1111/mec.13476 Evaluates various methods for finding genotype-by-environment associations and finds that RDA methods often best\nLasky, J. R., Josephs, E. B., & Morris, G. P. (2023). Genotype-environment associations to reveal the molecular basis of environmental adaptation. Plant Cell, 35, 125-138. doi:10.1093/plcell/koac267 Focusing on plants, reviews the strengths and shortcomings of GEA approaches\n\n\n\n\n\n\n\n\n\n\n\nSousa, V., Hey, J. Understanding the origin of species with genome-scale data: modelling gene flow.Nat Rev Genet 14, 404–414 (2013). https://doi.org/10.1038/nrg3446\nKelleher, J., Wong, Y., Wohns, A.W. et al. Inferring whole-genome histories in large population datasets. Nat Genet 51, 1330–1338 (2019). https://doi.org/10.1038/s41588-019-0483-y\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFitzpatrick, M. C., & Keller, S. R. (2015). Ecological genomics meets community-level modelling of biodiversity: mapping the genomic landscape of current and future environmental adaptation. Ecol Lett, 18(1), 1-16. doi:papers3://publication/doi/10.1111/ele.12376\n\n\n\n\n\nMokany, K., Ware, C., Woolley, S. N. C., Ferrier, S., Fitzpatrick, Matthew C., & Bahn, V. (2022). A working guide to harnessing generalized dissimilarity modelling for biodiversity analysis and conservation assessment. Global Ecology and Biogeography, 31(4), 802-821. doi:10.1111/geb.13459. A worked example for GDM\nFerrier, S., Manion, G., Elith, J., & Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. Diversity and Distributions, 13(3), 252-264. doi:papers3://publication/doi/10.1111/j.1472-4642.2007.00341.x Original method for GDM\nEllis, N., Smith, S. J., & Pitcher, C. R. (2012). Gradient forests: calculating importance gradients on physical predictors. Ecology, 93(1), 156-168. doi:papers3://publication/uuid/06CCD6BA-6A4B-49EB-AE26-736E8A04B9C8 Original method for GF\n\n\n\n\n\n\n\n\nJahnke, M., Jonsson, P. R., Moksnes, P. O., Loo, L. O., Nilsson Jacobi, M., & Olsen, J. L. (2017). Seascape genetics and biophysical connectivity modelling support conservation of the seagrass Zostera marina in the Skagerrak-Kattegat region of the eastern North Sea. Evolutionary Applications, 1-46. doi:papers3://publication/doi/10.1111/eva.12589 Comprehensive review of studies pairing seascape genetic data with biophysical models\n\n\n\n\n\nBoulanger, E., Dalongeville, A., Andrello, M., Mouillot, D., & Manel, S. (2020). Spatial graphs highlight how multi‐generational dispersal shapes landscape genetic patterns. Ecography. doi:10.1111/ecog.05024\n\n\n\n\n\n\n\n\n\n\n\nCapblancq, T., Fitzpatrick, M. C., Bay, R. A., Exposito-Alonso, M., & Keller, S. R. (2020). Genomic prediction of (mal)adaptation across current and future climatic landscapes. Annual Review of Ecology, Evolution, and Systematics, 51(1), 245-269. doi:10.1146/annurev-ecolsys-020720-042553 Review of maladaptation and genomic offset concepts\n\n\n\n\n\nGougherty, A. V., Keller, S. R., & Fitzpatrick, M. C. (2021). Maladaptation, migration and extirpation fuel climate change risk in a forest tree species. Nat Clim Change, 11(2), 166-171. doi:10.1038/s41558-020-00968-6 Interesting conceptual example that integrates genomic offsets with dispersal capacity\nFitzpatrick, M. C., V. E. Chhatre, R. Y. Soolanayakanahally and S. R. Keller, 2021 Experimental support for genomic prediction of climate maladaptation using the machine learning approach Gradient Forests. Mol Ecol Resour 21: 2749-2765. One of the best examples of an empirical test of GEA predictions\n\n\n\n\n\n\n\n(None)\n\n\n\n\nLaruson, A. J., Fitzpatrick, M. C., Keller, S. R., Haller, B. C., & Lotterhos, K. E. (2022). Seeing the forest for the trees: Assessing genetic offset predictions from gradient forest. Evol Appl, 15(3), 403-416. doi:10.1111/eva.13354\nLotterhos, K. E. (2019). The effect of neutral recombination variation on genome scans for selection. G3 (Bethesda), 9(6), 1851-1867. doi:10.1534/g3.119.400088\nBierne, N., Gagnaire, P.-A., & David, P. (2013). The geography of introgression in a patchy environment and the thorn in the side of ecological speciation. Current Zoology, 59(1), 72-86. doi:papers3://publication/doi/10.1093/czoolo/59.1.72"
  },
  {
    "objectID": "Readings.html#readings-by-day-and-topic",
    "href": "Readings.html#readings-by-day-and-topic",
    "title": "Readings",
    "section": "",
    "text": "For each topic, there will be a required reading (or pre-class activity) and several optional readings.\nWe expect you to have read the required reading before the day. There will not be time during the week of the course to read new materials and therefore we highly suggest that you do these readings in advance of the course starting.\n\n\n\n\n\n\nIf you are new to R, please attempt the following tutorials on your own. If you are experienced in R, skim through the tutorials and make sure that all the topics are familiar to you.\n\nRavinet’s introduction to R\nGoing further with R\n\nThrough this course, most of the examples you are likely to encounter will predominately use base R. However, learning Tidyverse syntax will make your life easier in the long run, especially if you are going to be manipulating spatial data.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nStorfer, A., Patton, A., & Fraik, A. K. (2018). Navigating the interface between landscape genetics and landscape genomics. Front Genet, 9, 68. doi:10.3389/fgene.2018.00068\n\n\n\n\n\nManel, S., Schwartz, M. K., Luikart, G., & Taberlet, P. (2003). Landscape genetics: combining landscape ecology and population genetics. Trends in Ecology and Evolution, 18(4), 189-197. doi:papers3://publication/doi/10.1016/S0169-5347(03)00008-9 This is the original paper defining landscape genetics as a field.\nFind a good terrestrial overview\nRiginos, C., & Liggins, L. (2013). Seascape genetics: populations, individuals, and genes marooned and adrift. Geography Compass, 7(3), 197-216. doi:papers3://publication/doi/10.1111/gec3.12032 Discusses many ways that marine landscape genetics is distinct from terrestrial\nSelkoe, K. A., Scribner, K. T., & Galindo, H. M. (2016). Waterscape genetics – applications of landscape genetics to rivers, lakes, and seas. In N. Balkenhol, S. A. Cushman, A. Storfer, & L. P. Waits (Eds.), Landscape Genetics: Concepts, Methods, Applications (pp. 1-27): John Wiley & Sons, Ltd. Includes overviews on some of the contrasting features of marine and freshwater environments\nLiggins, L., Treml, E. A., & Riginos, C. (2019). Seascape genomics: contextualizing adaptive and neutral genomic variation in the ocean environment. Overviews on issues particular to marine studies\nBlanchet, S., Prunier, J. G., Paz-Vinas, I., Saint-Pe, K., Rey, O., Raffard, A., Mathieu-Begne, E., Loot, G., Fourtune, L., & Dubut, V. (2020). A river runs through it: The causes, consequences, and management of intraspecific diversity in river networks. Evolutionary Applications, 13(6), 1195-1213. doi:10.1111/eva.12941 Features and emerging conclusions from freshwater systems\n\n\n\n\n\n\n\nNo readings are required.\n\n\n\n\nThe best website explaining how to use spatial data in R is [Geocomputation with R, a book on geographic data analysis, visualization and modeling](https://r.geocompx.org)\nLeempoel, K., Duruz, S., Rochat, E., Widmer, I., Orozco-terWengel, P., & Joost, S. (2017). Simple rules for an efficient use of geographic information systems in molecular ecology. _Frontiers in Ecology and Evolution, 5_. doi:10.3389/fevo.2017.00033 *Reviews various approaches and tools, good list of terrestrial environmental data sources included in appendix*\n\n\n\n\n\n\n\n\n\n\n\nMeier, J.I., Sousa, V.C., Marques, D.A., Selz, O.M., Wagner, C.E., Excoffier, L. and Seehausen, O. (2017), Demographic modelling with whole-genome data reveals parallel origin of similar Pundamilia cichlid species after hybridization. Mol Ecol, 26: 123-141. https://doi.org/10.1111/mec.13838\n\n\n\n\n\n\n\n\n\n\n\nCapblancq, T., & Forester, B. R. (2021). Redundancy analysis: A Swiss Army Knife for landscape genomics. Methods in Ecology and Evolution. doi:10.1111/2041-210x.13722 Clear explanations and worked examples that we will follow in class\n\n\n\n\n\nRellstab, C., Gugerli, F., Eckert, A. J., Hancock, A. M., & Holderegger, R. (2015). A practical guide to environmental association analysis in landscape genomics. Molecular Ecology, 24(17), 4348-4370. doi:papers3://publication/doi/10.1111/mec.13322 Highly recommend reading as a general overview to GEA/EEA analyses and concepts\nForester, B. R., Jones, M. R., Joost, S., Landguth, E. L., & Lasky, J. R. (2016). Detecting spatial genetic signatures of local adaptation in heterogeneous landscapes. Molecular Ecology, 25(1), 104-120. doi:papers3://publication/doi/10.1111/mec.13476 Evaluates various methods for finding genotype-by-environment associations and finds that RDA methods often best\nLasky, J. R., Josephs, E. B., & Morris, G. P. (2023). Genotype-environment associations to reveal the molecular basis of environmental adaptation. Plant Cell, 35, 125-138. doi:10.1093/plcell/koac267 Focusing on plants, reviews the strengths and shortcomings of GEA approaches\n\n\n\n\n\n\n\n\n\n\n\nSousa, V., Hey, J. Understanding the origin of species with genome-scale data: modelling gene flow.Nat Rev Genet 14, 404–414 (2013). https://doi.org/10.1038/nrg3446\nKelleher, J., Wong, Y., Wohns, A.W. et al. Inferring whole-genome histories in large population datasets. Nat Genet 51, 1330–1338 (2019). https://doi.org/10.1038/s41588-019-0483-y\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFitzpatrick, M. C., & Keller, S. R. (2015). Ecological genomics meets community-level modelling of biodiversity: mapping the genomic landscape of current and future environmental adaptation. Ecol Lett, 18(1), 1-16. doi:papers3://publication/doi/10.1111/ele.12376\n\n\n\n\n\nMokany, K., Ware, C., Woolley, S. N. C., Ferrier, S., Fitzpatrick, Matthew C., & Bahn, V. (2022). A working guide to harnessing generalized dissimilarity modelling for biodiversity analysis and conservation assessment. Global Ecology and Biogeography, 31(4), 802-821. doi:10.1111/geb.13459. A worked example for GDM\nFerrier, S., Manion, G., Elith, J., & Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. Diversity and Distributions, 13(3), 252-264. doi:papers3://publication/doi/10.1111/j.1472-4642.2007.00341.x Original method for GDM\nEllis, N., Smith, S. J., & Pitcher, C. R. (2012). Gradient forests: calculating importance gradients on physical predictors. Ecology, 93(1), 156-168. doi:papers3://publication/uuid/06CCD6BA-6A4B-49EB-AE26-736E8A04B9C8 Original method for GF\n\n\n\n\n\n\n\n\nJahnke, M., Jonsson, P. R., Moksnes, P. O., Loo, L. O., Nilsson Jacobi, M., & Olsen, J. L. (2017). Seascape genetics and biophysical connectivity modelling support conservation of the seagrass Zostera marina in the Skagerrak-Kattegat region of the eastern North Sea. Evolutionary Applications, 1-46. doi:papers3://publication/doi/10.1111/eva.12589 Comprehensive review of studies pairing seascape genetic data with biophysical models\n\n\n\n\n\nBoulanger, E., Dalongeville, A., Andrello, M., Mouillot, D., & Manel, S. (2020). Spatial graphs highlight how multi‐generational dispersal shapes landscape genetic patterns. Ecography. doi:10.1111/ecog.05024\n\n\n\n\n\n\n\n\n\n\n\nCapblancq, T., Fitzpatrick, M. C., Bay, R. A., Exposito-Alonso, M., & Keller, S. R. (2020). Genomic prediction of (mal)adaptation across current and future climatic landscapes. Annual Review of Ecology, Evolution, and Systematics, 51(1), 245-269. doi:10.1146/annurev-ecolsys-020720-042553 Review of maladaptation and genomic offset concepts\n\n\n\n\n\nGougherty, A. V., Keller, S. R., & Fitzpatrick, M. C. (2021). Maladaptation, migration and extirpation fuel climate change risk in a forest tree species. Nat Clim Change, 11(2), 166-171. doi:10.1038/s41558-020-00968-6 Interesting conceptual example that integrates genomic offsets with dispersal capacity\nFitzpatrick, M. C., V. E. Chhatre, R. Y. Soolanayakanahally and S. R. Keller, 2021 Experimental support for genomic prediction of climate maladaptation using the machine learning approach Gradient Forests. Mol Ecol Resour 21: 2749-2765. One of the best examples of an empirical test of GEA predictions\n\n\n\n\n\n\n\n(None)\n\n\n\n\nLaruson, A. J., Fitzpatrick, M. C., Keller, S. R., Haller, B. C., & Lotterhos, K. E. (2022). Seeing the forest for the trees: Assessing genetic offset predictions from gradient forest. Evol Appl, 15(3), 403-416. doi:10.1111/eva.13354\nLotterhos, K. E. (2019). The effect of neutral recombination variation on genome scans for selection. G3 (Bethesda), 9(6), 1851-1867. doi:10.1534/g3.119.400088\nBierne, N., Gagnaire, P.-A., & David, P. (2013). The geography of introgression in a patchy environment and the thorn in the side of ecological speciation. Current Zoology, 59(1), 72-86. doi:papers3://publication/doi/10.1093/czoolo/59.1.72"
  },
  {
    "objectID": "maps-spatial-data.html",
    "href": "maps-spatial-data.html",
    "title": "Maps & spatial data",
    "section": "",
    "text": "Instructor: Riginos"
  },
  {
    "objectID": "maps-spatial-data.html#examining-and-creating-a-simple-features-objects",
    "href": "maps-spatial-data.html#examining-and-creating-a-simple-features-objects",
    "title": "Maps & spatial data",
    "section": "Examining and creating a simple features objects",
    "text": "Examining and creating a simple features objects\nTo start getting familiar with spatial objects, we will download a simple map of Sweden from natural earth. Take a quick look at this website to get a sense of all the wonderful data that are available here. (You are welcome to make a map of any country you like).\n\n#Extract information from natural earth\nSweden&lt;- ne_countries(country = \"sweden\", returnclass = \"sf\") \nplot(Sweden) \n#Surprised? We will come back to this.\n\n#Examine your new object \nclass(Sweden) #sf and data.frame\nSweden #tibble-like format!\n\nChecking spatial data using plots (often) is highly recommended. You should also check the class of the object. The challenge question below shows you how to handle data that are imported incorrectly.\n\nChallenge 1: Use subsetting commands to look at the first entry under the geometry column\n\n\nInstead of the command you used above, try Sweden2&lt;- ne_countries(country = \"sweden\"). Using class() look at how the object is described and compare to your original object. What has happened is that rather than create an sf object, the older format of sp has been created. See if you can convert Sweden2 to the sf format using the function st_as_sf().\n\nNotice that spatial features objects take the form of a tibble. This means that all your standard Tidyverse commands will work just fine (selecting, filtering, etc).\nYou will also notice that there is information about a “bounding box” and “CRS” in your sf version of Sweden where in the sp version of Sweden2 you saw “extent” and “crs”. We will come back to that! Otherwise this object mostly looks like a normal tibble with lots of columns, but there is one special column, labelled geometry. You will notice that for Sweden the geometry is described as a “MULTIPOLYGON”… more on this in a moment too.\n\nChallenge 2: Use subsetting commands to look at the first entry under the geometry column. Answers at end of this document, but you should be able to figure out these bits of code yourself! Try doing this using either base or tidy syntax, or both.\n\nYou should have an answer like this:\n\nPOLYGON ((11.02737 58.85615, 11.46827 59.43239, 12.30037 60.11793, 12.63115 61.29357, 11.99206 61.80036, 11.93057 63.12832……\n\nBesides being an eyesore to look at, you might notice some patterns: the odd entries look a lot like longitude values and the even entries look like latitudes… because they are! This POLYGON is composed of a series of points that are connected to form the Swedish coastline.\nWe can get a better feeling for this with a simple example where we construct a series of simple features (this example is borrowed from the sf vignette). Try to understand what is going on with each bit of code.\n\n## multipoints\np &lt;- rbind(c(3.2,4), c(3,4.6), c(3.8,4.4), c(3.5,3.8), c(3.4,3.6), c(3.9,4.5))  #makes a matrix of x & y value \nmp &lt;- st_multipoint(p)  #defining p as multipoint object\nplot(mp)  #you should see a series of points \n## linestring\ns1 &lt;- rbind(c(0,3),c(0,4),c(1,5),c(2,5))\nls &lt;- st_linestring(s1) # defining the linestring\nplot(ls) #you should see a series of lines\n\n## multilinestring\ns2 &lt;- rbind(c(0.2,3), c(0.2,4), c(1,4.8), c(2,4.8))\ns3 &lt;- rbind(c(0,4.4), c(0.6,5))\nmls &lt;- st_multilinestring(list(s1,s2,s3)) #notice the list function... #... applied to the matrices defining linestrings\nplot(mls)\n## multipolygon\np1 &lt;- rbind(c(0,0), c(1,0), c(3,2), c(2,4), c(1,4), c(0,0))\npol1 &lt;-st_polygon(list(p1))  \nplot(pol1)  \np2 &lt;- rbind(c(1,1), c(1,2), c(2,2), c(1,1))\npol2 &lt;-st_polygon(list(p2))\nplot(pol2)\n## What happens if we combine polygons?\npol &lt;-st_polygon(list(p1,p2))  #notice again the list function\nplot(pol)  # do you see 2 polygons?  \n# The second polygon is a \"hole\" in the outer polygon!\n\n## Now make it really messy!\np3 &lt;- rbind(c(3,0), c(4,0), c(4,1), c(3,1), c(3,0))\np4 &lt;- rbind(c(3.3,0.3), c(3.8,0.3), c(3.8,0.8), c(3.3,0.8), c(3.3,0.3))[5:1,]\np5 &lt;- rbind(c(3,3), c(4,2), c(4,3), c(3,3))\n# What do you think the following will look like? \n# Test your predictions using plot()\nmpol &lt;- st_multipolygon(list(list(p1,p2), list(p3,p4), list(p5))) \n\nTake a look again at your mpol object. As messy as this was to create, this is a pretty simple geometry and is captured by one MULTIPOLYGON entry. Go back now and look at mpol in its string form paying special attention to where the parentheses sit; their locations indicate if you have multiple polygons including holes within polygons.\n\nChallenge 3: Make a grey square with a square hole in the middle."
  },
  {
    "objectID": "maps-spatial-data.html#playing-with-some-real-spatial-data",
    "href": "maps-spatial-data.html#playing-with-some-real-spatial-data",
    "title": "Maps & spatial data",
    "section": "Playing with some real spatial data",
    "text": "Playing with some real spatial data\nOnly rarely do we need to manually create spatial feature. More likely we have data pre-packaged or we need to convert data. Use this link to download a csv file that has data for trees from the Bunya Mountains National Park in Queensland (one of my favorite places to go for a long weekend). These data come from my friend John Dwyer who is an awesome spatial ecologist (but is scared by genetics, sadly).\nImport this csv file making sure to fix the path and file name to match your set up. Before you convert the dataframe to a spatial features object take at look at how it is structured. Repeat this after you convert it.\n\n#load data\nBunyaMountainTrees&lt;-read_csv(\"./data/BunyaMountainTrees.csv\")\n\n#Convert the tibble to a simple features object, with x and y coordinates\n# Each row is a tree \nBunyaMountainTrees&lt;-st_as_sf(BunyaMountainTrees, coords = c(\"x\", \"y\")) \n\nWhat will plot(BunyaMountainTrees) look like? Surprised? (Does this remind you of what happened when you plotted Sweden?)\nTry plot(BunyaMountainTrees, max.plot = 28). Although this might be confusing at first, this is really super cool… you are seeing the various column variables displayed in the appropriate location by individual tree. For now, we can concentrate on the species variable only. Try plot(BunyaMountainTrees[\"species\"]). How cool is that! Let’s make this even better…\nWe will focus on ggplot solutions now, because the look nicer and are a bit easier.\n\nggplot(data = BunyaMountainTrees) +\n        geom_sf(aes(col=species))\n\n\nChallenge 4: Plot species identity for high-subplot 1, scaling the points by maximum tree diameter. Hint: Think about what units max_diam is in.\n\nNotice which tree is the largest? It is a Ficus obliqua, the small leaf or strangler fig. Because they wrap around other trees and have buttressed roots, they can get quite wide around.\n Now that your data in in the sf format, there are many other things you can do. For example, you could examine the distance between all pairs of trees.\n\ndistances&lt;-st_distance(BunyaMountainTrees, BunyaMountainTrees) #calculate distances, but this returns a symmetrical matrix\n\ndistances&lt;-distances[lower.tri(distances)] #lower.tri returns T/F values...see if you can follow the subsetting being used here\nggplot(data = as.data.frame(distances)) +\n  geom_histogram(mapping = aes(x = distances))\n\nKeep in mind that the data are bounded by the size of the subplot. But it is interesting that you do not get too many trees very close together…why do you think that might be?\nThis function is very useful - for example you might want to calculate distances between your sampling locations to look for patterns of isolation by distance. When your data are in an x-y plane, st_distance will return the Euclidean distance. When your data are projected (see next section), then st_distance will calculate the distance on Earth’s sphere. Most of the commands in sf will automatically adjust when your data are spherical. But, it is worth occasionally checking and when you see very odd results, keeping in mind that an inappropriate distance measure is being used."
  },
  {
    "objectID": "Teachers.html",
    "href": "Teachers.html",
    "title": "Meet your teachers",
    "section": "",
    "text": "(University of Queensland, guest professor at University of Gothenburg)"
  },
  {
    "objectID": "Teachers.html#cynthia-riginos",
    "href": "Teachers.html#cynthia-riginos",
    "title": "Meet your teachers",
    "section": "",
    "text": "(University of Queensland, guest professor at University of Gothenburg)"
  },
  {
    "objectID": "Teachers.html#anna-runemark",
    "href": "Teachers.html#anna-runemark",
    "title": "Meet your teachers",
    "section": "Anna Runemark",
    "text": "Anna Runemark\n(Lund University)"
  },
  {
    "objectID": "Teachers.html#mark-ravinet",
    "href": "Teachers.html#mark-ravinet",
    "title": "Meet your teachers",
    "section": "Mark Ravinet",
    "text": "Mark Ravinet\n(University of Nottingham)"
  },
  {
    "objectID": "Teachers.html#kerstin-johannesson",
    "href": "Teachers.html#kerstin-johannesson",
    "title": "Meet your teachers",
    "section": "Kerstin Johannesson",
    "text": "Kerstin Johannesson\n(University of Gothenburg, main organiser)"
  },
  {
    "objectID": "Teachers.html#per-jonsson",
    "href": "Teachers.html#per-jonsson",
    "title": "Meet your teachers",
    "section": "Per Jonsson",
    "text": "Per Jonsson\n(University of Gothenburg)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About the course",
    "section": "",
    "text": "How spatial data on properties of terrestrial and marine environments can be combined with genomic data to gain an understanding of population structure, dispersal routes and patterns. And how such can facilitate appropriate and sustainable land and seabottom use and management."
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "About the course",
    "section": "",
    "text": "How spatial data on properties of terrestrial and marine environments can be combined with genomic data to gain an understanding of population structure, dispersal routes and patterns. And how such can facilitate appropriate and sustainable land and seabottom use and management."
  },
  {
    "objectID": "index.html#teachers",
    "href": "index.html#teachers",
    "title": "About the course",
    "section": "Teachers",
    "text": "Teachers\nCynthia Riginos (University of Queensland, guest professor at University of Gothenburg)\nAnna Runemark (Lund University)\nMark Ravinet (University of Nottingham)\nKerstin Johannesson (University of Gothenburg, main organiser)\nPer Jonsson (University of Gothenburg)"
  },
  {
    "objectID": "index.html#dates",
    "href": "index.html#dates",
    "title": "About the course",
    "section": "Dates",
    "text": "Dates\n29th October to 4 November, 2023"
  },
  {
    "objectID": "index.html#venue",
    "href": "index.html#venue",
    "title": "About the course",
    "section": "Venue",
    "text": "Venue\nTjärnö Marine Laboratory, Strömstad, Sweden"
  },
  {
    "objectID": "index.html#credits",
    "href": "index.html#credits",
    "title": "About the course",
    "section": "Credits",
    "text": "Credits\n2.5 hp"
  },
  {
    "objectID": "index.html#friday-3rd-november",
    "href": "index.html#friday-3rd-november",
    "title": "About the course",
    "section": "Friday 3rd November",
    "text": "Friday 3rd November\n(meals and breaks same schedule as Sunday)\n09.00-12.00     More GEAs and genomic offsets (Cynthia)\n12.00-14.00     Lunch + walk & talk\n14.00-17.00     (Time permiting) Landscape genomics and genetic architectures\n17.00-18.00     Dinner\n19.00-23.00     Inhouse pub\n\nSaturday 4th November\nDepartures in the morning -sorry to see you go!"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "RDA.html",
    "href": "RDA.html",
    "title": "Intro to GEA & RDA as a general toolkit",
    "section": "",
    "text": "What are they"
  },
  {
    "objectID": "RDA.html#review-of-ordination-pca-pcoa",
    "href": "RDA.html#review-of-ordination-pca-pcoa",
    "title": "Intro to GEA & RDA as a general toolkit",
    "section": "Review of ordination, PCA & PCoA",
    "text": "Review of ordination, PCA & PCoA"
  },
  {
    "objectID": "RDA.html#constrained-ordination-as-implemented-in-rda",
    "href": "RDA.html#constrained-ordination-as-implemented-in-rda",
    "title": "Intro to GEA & RDA as a general toolkit",
    "section": "Constrained ordination as implemented in RDA",
    "text": "Constrained ordination as implemented in RDA\n\nFlexible\n\nRDA can address the following questions (citing Capblancq et al. 2021):\n\nWhat environmental/spatial processes drive patterns of genetic variation?\n\n2. What is the genetic basis of local adaptation to the environment?\n3. How is adaptive genetic variation distributed across landscapes?\n4. What are the impacts of climate and/or landscape change on the distribution of adaptive genetic variation?\nRDA takes linear combinations of the explanatory variables (X) and uses them to maximise the variance explained in linear combinations of Y (where X and Y are matrices)\n\nKeep this linearity in mind: it might not be appropriate for your data\n\n\n\n\nConceptual overview of RDA - From Capblancq et al. 2021"
  },
  {
    "objectID": "RDA.html#data-preparation",
    "href": "RDA.html#data-preparation",
    "title": "Intro to GEA & RDA as a general toolkit",
    "section": "Data preparation",
    "text": "Data preparation\nget environmental variables\nstandardize - mean of 0, SD = 1\ncan include dummy predictors (0/1)\n\nexplain when more than two categories\n\nlook for colinearity - need to define and explain VIF\n\nVariable selection with forward model building\nBuilds up a predictive model and assists with variable reduction\n\nTest significance of global model (= all variables)\nStart with “empty” model (= intercept only) and sequentially add variables\nTwo stopping criteria to avoid overfitting - end with either criterion\n\npermutation based significance test\nadjusted \\(R^2\\) from global model\n\n\n\n\n\nVariance partitioning using partial RDA\nAllows independent estimation of sets of variables together with confounded effects caused by collinearity\n\n\n\nReporting on partial RDA-From Capblancq et al. 2021\n\n\nDefine the different proportions\n? make MCQ check"
  },
  {
    "objectID": "RDA.html#extra-topics",
    "href": "RDA.html#extra-topics",
    "title": "Intro to GEA & RDA as a general toolkit",
    "section": "Extra topics",
    "text": "Extra topics\nMEMS\nAEMS"
  },
  {
    "objectID": "maps-spatial-data.html#understanding-and-assigning-coordinate-reference-systems-crs",
    "href": "maps-spatial-data.html#understanding-and-assigning-coordinate-reference-systems-crs",
    "title": "Maps & spatial data",
    "section": "Understanding and assigning Coordinate Reference Systems (CRS)",
    "text": "Understanding and assigning Coordinate Reference Systems (CRS)\nTo start a deeper dive into CRS’s, go back to your now familiar Sweden object. Enter Sweden and also st_crs(Sweden).\nHere we can see that the projection is longlat (= longitude and latitude), with datum (starting point, or 0 value) at WGS84 (= equator with longitude set at the prime meridian or Greenwich, UK).\nWe can also find the bounding box or extent of the spatial object, which represents the rectangular shape in which our map sits, where x & y positions are reported using decimal longitude and latitude. Try st_boundary(Sweden))\nNote to your future self - longitude and latitude are very commonly reported incorrectly or in mixed formats. For example, rather than a decimal latitude of -38.2685, you might encounter 38° 16’ 6.6’’ S in degree-minute-second format. Or even worse you might get a mixture such as 38° 16.11’S ! Plot your data early on in any analysis to spot potential problems.\nWhat about BunyaMountainTrees? Try to see what CRS is assigned….nothing! And actually given that we were just using x and y coordinates in meters, that’s fine. But, if we wanted to plot the data on a map we would have problems.\nA file that accompanies BunyaMountainTrees is BunyaMountainSites. Import this and examine it. You might notice some funny variables called “easting” and “northing”; these are the positions of the plot sites in meters distant from a datum, a format called UTM or Universal Transverse Mercator. (A negative northing is in the southern direction.)\nIn order to attach the correct CRS details, however, we still need information on the projection…. Some further digging around on information provided by the authors gives us the following:\n\nLocation: Bunya Mountain National Park, Queensland Australia. Five areas of rainfortest or vine thicket were surveyed along a topographic moisture gradient: ‘high’ (easting = 359342, northing = 7027160) ‘low_east’ (365676, 7028551) ‘low_west’ (350888, 7030875) ‘mid_east’ (360196, 7027612) ‘mid_west’ (354971, 7031460) All eastings and northings in WGS84, zone 56.\n\nNotice “WGS84, zone 56”. (Although N and S are not stated, we can guess that the projection is S since the Bunya Mountains are in the southern hemisphere!) Once you find the projection description, google it, and you will be likely directed to the relevant EPSG site. Here, we can use either the EPSG number or (scrolling down the page) copy the PROJ.4 text.\nHere is how we assign the correct CRS to `BunyaMountainSites` and also turn it into an sf object.\n\nBunyaMountainSites &lt;-read_csv(\"./data/BunyaMountainSites.csv\")\n\nBunyaMountainSites_sf&lt;-st_as_sf(BunyaMountainSites, coords = c(\"easting\", \"northing\"))  #convert the tibble to an sf object \nst_crs(BunyaMountainSites_sf) &lt;-\"EPSG:32756\"\n#or\nst_crs(BunyaMountainSites_sf) &lt;-\"+proj=utm +zone=56 +south +datum=WGS84 +units=m +no_defs\"\n\n#or we can convert and assign CRS in one step:\nBunyaMountainSites_sf&lt;-st_as_sf(BunyaMountainSites_sf, coords = c(\"easting\", \"northing\"), crs=\"+proj=utm +zone=56 +south +datum=WGS84 +units=m +no_defs\")  \n\nThe website EPSG has lots of searchable information about CRS’s and projections; spend some time looking through their website. (Random trivia: EPSG stands for European Petroleum Survey Group. They created standards that have been widely adopted. EPSG is no longer associated with any industry group but the name persists.)"
  },
  {
    "objectID": "maps-spatial-data.html#transforming-and-reprojecting-crss",
    "href": "maps-spatial-data.html#transforming-and-reprojecting-crss",
    "title": "Maps & spatial data",
    "section": "Transforming and reprojecting CRS’s",
    "text": "Transforming and reprojecting CRS’s\nWe have succeeded in adding a CRS to our BunyaMountainSites_sf object…but is it correct? A handy quick check would be to plot it on our map of Australia. How can we do this? First, import a map of Australia as you did earlier for Sweden and use the st_crs() function to look at the CRS’s of each object…are they the same?\nTo convert the CRS of bunya_sites_sf to match Australia is quite straightforward using the st_transform() function that undertakes a lot of serious geometric calculations for us. We can do this a number of ways:\n\n# import map of Australia from natural earth\nAustralia&lt;- ne_countries(country = \"australia\", returnclass = \"sf\") \nst_crs(Australia)\n\n# transform CRS\nBunyaMountainSites.wgs84&lt;-st_transform(BunyaMountainSites_sf, crs=4326)\n#or\nBunyaMountainSites.wgs84&lt;-st_transform(BunyaMountainSites_sf, crs=\"+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0\")\n#or\nBunyaMountainSites.wgs84&lt;-st_transform(BunyaMountainSites_sf, st_crs(Australia))\n#All of these methods are equivalent\n\nNow to plot these points on the map…\n\nggplot(data = Australia) +\n  geom_sf() +  #background map needs to be first argument \n  geom_sf(data = BunyaMountainSites.wgs84, size = 4, shape = 23, fill = \"darkred\") #our sites plotted on top\n\nWhy have I had you play around with this dataset on Australian trees? Because this dataset presents some of the irregularities and problems you might face when finding spatial data. You will often have to do some detective work and guessing to find and assign the correct CRS. Always test by plotting your data!\nConsider three commonly used but different CRS’s:\n\nEPSG: 4326 = WGS84. For the whole earth, used by most GPS’s and Google Earth. Not equal area and technically not really projected. This one is an all-around compromise. It is centered on the equator and prime meridian\nEPSG:3006 = SWEREF99: This is for all of Sweden. It is a conformal projection that attempts to make both distances and area well represented. Good for making Swedish maps and Swedish focused analyses.\nLambert Equal Area Azimuthal = LAEA: equal area projection and can be centered where we choose.\n\nOur data is already in WGS84 but if we needed to define it the code would be:\nWGS&lt;-\"+proj=longlat +datum=WGS84 +no_defs\"\nThe code for SWEREF99 is: SWEREF99 &lt;- \"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs\"\nAnd for LAEA centered on the WGS84 datum: LAEA &lt;- \"+proj=laea  +lat_0=0 +lon_0=0\" (to center in Sweden: laea &lt;- \"+proj=laea  +lat_0=16.321998712 +lon_0=62.38583179\")\nTo see what those different projections look like, we can got back to our map of Sweden. We can reproject the CRS as follows:\n\nWGS&lt;-\"+proj=longlat +datum=WGS84 +no_defs\"\n\nSWEREF99 &lt;- \"+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs +type=crs\"\n\nLAEA &lt;- \"+proj=laea  +lat_0=16.321998712 +lon_0=62.38583179\"\n\nSweden.SWEREF99 &lt;-st_transform(Sweden, SWEREF99)\nSweden.LAEA&lt;-st_transform(Sweden, LAEA)\n\n\nChallenge 5: Plot your original Sweden WGS and two reprojected maps. Then, change the LAEA projection to be centred on the prime meridien and plot that map again.\n\nNote to your future self Make sure that CRS are the same between objects that you are seeking to compare and map. It is easy to get caught out.\nAdd example of reading in river data"
  },
  {
    "objectID": "maps-spatial-data.html#note-to-your-future-self-make-sure-that-crs-are-the-same-between-objects-that-you-are-seeking-to-compare-and-map.-it-is-easy-to-get-caught-out.",
    "href": "maps-spatial-data.html#note-to-your-future-self-make-sure-that-crs-are-the-same-between-objects-that-you-are-seeking-to-compare-and-map.-it-is-easy-to-get-caught-out.",
    "title": "Maps & spatial data",
    "section": "Note to your future self Make sure that CRS are the same between objects that you are seeking to compare and map. It is easy to get caught out.",
    "text": "Note to your future self Make sure that CRS are the same between objects that you are seeking to compare and map. It is easy to get caught out."
  },
  {
    "objectID": "maps-spatial-data.html#working-with-spatial-data-generally",
    "href": "maps-spatial-data.html#working-with-spatial-data-generally",
    "title": "Maps & spatial data",
    "section": "Working with spatial data generally",
    "text": "Working with spatial data generally\nFantastic and comprehensive entry level open source book. Geocomputation with R\nGeneral explanations on using R for biological spatial data including remote sensing rspatial.org\nA series of well explained tutorials for making publication-ready maps:\n\nPart 1: Basics\nPart 2: Layers\nPart 3: Layouts\n\nAnother open source book: Spatial Data Science"
  },
  {
    "objectID": "maps-spatial-data.html#specific-r-package-support",
    "href": "maps-spatial-data.html#specific-r-package-support",
    "title": "Maps & spatial data",
    "section": "Specific R package support",
    "text": "Specific R package support\nsf package vignettes - these are rather technical\nmarmap package with excellent vignettes - an essential resource if using marine data that allows you to draw bathymetric maps\nsdmpredictors package - an essential resource if using marine data that provide access to marine environmental layers in Bio-Oracle (analogous to BioClim)"
  }
]